import { round } from 'curvy/utils'
import { Array as Arr, Effect } from 'effect'
import { generateGamut } from './gamut.ts'
import { fitSphericalHarmonics } from './squares.ts'
import { CacheStorage } from './storage.ts'

export const program = Effect.gen(function* () {
	const points = yield* generateGamut({
		subdivisions: 5,
		huePasses: 2,
		lightnessPasses: 1,
	})

	yield* Effect.log(`using ${points.length} points`)

	const result = yield* fitSphericalHarmonics(points, 32)

	yield* Effect.log('result', result)
})

const foo = {
	'0,0': 3.088047340567712,
	'2,0': 0.16037650247784152,
	'2,2': 0.02352590620826748,
	'4,0': 0.09805183658992693,
	'4,2': 0.05230066627451192,
	'4,4': -0.019135333434638573,
	'6,0': -0.09801419557822032,
	'6,2': -0.032065171565481734,
	'6,4': -0.07889300152945293,
	'6,6': 0.05380950504092267,
	'8,0': 0.07603206979690584,
	'8,2': 0.010660901356342999,
	'8,4': 0.031410048954654865,
	'8,6': -0.03274547657166209,
	'8,8': -0.026066223413577814,
	'10,0': -0.051823511538470195,
	'10,4': -0.017644939756829462,
	'10,10': -0.03135069340867037,
	'12,0': 0.03339680870561261,
	'12,2': -0.008208723671904424,
	'12,6': 0.006713544015412863,
	'12,8': 0.023514274169527706,
	'12,10': -0.05066850641436286,
	'12,12': -0.014113844918432872,
	'14,0': -0.026442188986912682,
	'14,2': 0.007048901183112446,
	'14,4': 0.010773333202003505,
	'14,6': -0.011363556532676638,
	'14,8': -0.014076557899370382,
	'14,10': -0.031956908329245456,
	'16,0': 0.01868884343664324,
	'16,2': -0.005642664210944139,
	'16,4': -0.016045700883887844,
	'16,6': 0.00932361440326331,
	'16,8': 0.006578869660488754,
	'16,14': 0.01644475366759425,
	'16,16': 0.01132713693098231,
	'18,0': -0.016992496587948856,
	'18,4': 0.015706168028805267,
	'18,6': -0.008827889820028065,
	'18,10': -0.009532795037955791,
	'18,16': 0.010862821925887198,
	'20,0': 0.014532601473827504,
	'20,4': -0.013190958703173687,
	'20,6': 0.007720253301702785,
	'20,10': -0.008745100164391558,
	'20,12': -0.005190915232897161,
	'20,14': 0.00844654358515682,
	'20,16': -0.012136897910486364,
	'20,18': -0.011462537650280291,
	'22,0': -0.012354583269049972,
	'22,4': 0.010378803634968039,
	'22,6': -0.007469823454266882,
	'22,12': 0.005574283837056121,
	'22,18': 0.01197201691002233,
	'22,20': -0.006175657575154513,
	'22,22': -0.009242163808670833,
	'24,0': 0.012301183509306087,
	'24,4': -0.007071070754714297,
	'24,6': 0.006613289257312381,
	'24,10': -0.00736064885565113,
	'24,22': -0.006068249029977352,
	'24,24': 0.005835400310340983,
	'26,0': -0.011075971902397144,
	'26,6': -0.005728111901695873,
	'26,20': -0.009149907158514655,
	'26,24': 0.016016648452043772,
	'28,0': 0.009803479962423343,
	'30,0': -0.008660549316866096,
	'30,24': 0.01128951974021263,
	'30,30': -0.005717329081539371,
	'32,0': 0.006513184190746296,
	'32,24': 0.0053896592720599915,
	'32,30': -0.007922725427160953,
	'34,26': -0.0059785580034477145,
}
